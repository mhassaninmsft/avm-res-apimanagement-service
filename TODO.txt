
│ Error: creating Monitor Diagnostics Setting "amlmds-zwn5" for Resource "/subscriptions/aa27a1b3-530a-4637-a1e6-6855033a65e5/resourceGroups/apimzwn5/providers/Microsoft.ApiManagement/service/apimzwn5": unexpected status 400 (400 Bad Request) with response: {"code":"BadRequest","message":"Diagnostic setting does not support mix of log category and log category group."}
│ 
│   with module.test.azurerm_monitor_diagnostic_setting.this["diag"],
│   on ../../main.diagnostics.tf line 1, in resource "azurerm_monitor_diagnostic_setting" "this":
│    1: resource "azurerm_monitor_diagnostic_setting" "this" {
│ 
╵
mhassani@NitroPC:~/projects/avm-res-apimanagement-service/examples/telemetry123(mhassnain/initial)$ terraform plan
module.test.data.modtm_module_source.telemetry[0]: Reading...
module.test.random_uuid.telemetry[0]: Refreshing state... [id=cbbd2434-66c1-cf62-bfa9-c14876255c0d]
module.naming.random_string.first_letter: Refreshing state... [id=z]
module.test.data.modtm_module_source.telemetry[0]: Read complete after 0s
module.naming.random_string.main: Refreshing state... [id=wn5v3v11xhiftbrw2vvsrdnm5oobkmo5l3v1uea37n3u7zpp7pwh2xxb64bq]
module.test.data.azurerm_client_config.telemetry[0]: Reading...
module.test.azurerm_resource_group.this: Refreshing state... [id=/subscriptions/aa27a1b3-530a-4637-a1e6-6855033a65e5/resourceGroups/apimzwn5]
module.test.data.azurerm_client_config.telemetry[0]: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9OTJkZWU1ODMtY2YxMi00NzA4LTgxNWEtMjYzZGFlZTQ1ZGU0O3N1YnNjcmlwdGlvbklkPWFhMjdhMWIzLTUzMGEtNDYzNy1hMWU2LTY4NTUwMzNhNjVlNTt0ZW5hbnRJZD0xNmIzYzAxMy1kMzAwLTQ2OGQtYWM2NC03ZWRhMDgyMGI2ZDM=]
module.test.modtm_telemetry.telemetry[0]: Refreshing state... [id=6f89eb42-021c-42f3-81d2-3831837cd2d4]
module.test.azurerm_api_management.this: Refreshing state... [id=/subscriptions/aa27a1b3-530a-4637-a1e6-6855033a65e5/resourceGroups/apimzwn5/providers/Microsoft.ApiManagement/service/apimzwn5]
module.regions.data.azurerm_client_config.current: Reading...
module.regions.data.azurerm_client_config.current: Read complete after 0s [id=Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9OTJkZWU1ODMtY2YxMi00NzA4LTgxNWEtMjYzZGFlZTQ1ZGU0O3N1YnNjcmlwdGlvbklkPWFhMjdhMWIzLTUzMGEtNDYzNy1hMWU2LTY4NTUwMzNhNjVlNTt0ZW5hbnRJZD0xNmIzYzAxMy1kMzAwLTQ2OGQtYWM2NC03ZWRhMDgyMGI2ZDM=]
random_integer.region_index: Refreshing state... [id=21]
azurerm_resource_group.this: Refreshing state... [id=/subscriptions/aa27a1b3-530a-4637-a1e6-6855033a65e5/resourceGroups/rg-zwn5]
azurerm_log_analytics_workspace.diag: Refreshing state... [id=/subscriptions/aa27a1b3-530a-4637-a1e6-6855033a65e5/resourceGroups/rg-zwn5/providers/Microsoft.OperationalInsights/workspaces/diaglog-zwn5]

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # module.test.azurerm_monitor_diagnostic_setting.this["diag"] will be created
  + resource "azurerm_monitor_diagnostic_setting" "this" {
      + id                             = (known after apply)
      + log_analytics_destination_type = "Dedicated"
      + log_analytics_workspace_id     = "/subscriptions/aa27a1b3-530a-4637-a1e6-6855033a65e5/resourceGroups/rg-zwn5/providers/Microsoft.OperationalInsights/workspaces/diaglog-zwn5"
      + name                           = "amlmds-zwn5"
      + target_resource_id             = "/subscriptions/aa27a1b3-530a-4637-a1e6-6855033a65e5/resourceGroups/apimzwn5/providers/Microsoft.ApiManagement/service/apimzwn5"

      + enabled_log {
          + category_group = "allLogs"
            # (1 unchanged attribute hidden)
        }
      + enabled_log {
          + category       = "DeveloperPortalLogs"
            # (1 unchanged attribute hidden)
        }
      + enabled_log {
          + category       = "GatewayLogs"
            # (1 unchanged attribute hidden)
        }
      + enabled_log {
          + category       = "WebSocketConnectionLogs"
            # (1 unchanged attribute hidden)
        }

      + metric {
          + category = "AllMetrics"
          + enabled  = true
        }
    }

Plan: 1 to add, 0 to change, 0 to destroy.

─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

Note: You didn't use the -out option to save this plan, so Terraform can't guarantee to take exactly these actions if you run "terraform apply" now.

# add validation that either category or category group is set
